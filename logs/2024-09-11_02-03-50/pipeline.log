2024-09-11 02:03:50,424 - INFO - Logging initialized. Logs will be saved in: ..\logs\2024-09-11_02-03-50\pipeline.log
2024-09-11 02:03:50,483 - INFO - Connected to database: b2b_platform_db
2024-09-11 02:03:50,517 - INFO - Connected to database: dimensional_model_db
2024-09-11 02:03:50,517 - INFO - ETL pipeline started
2024-09-11 02:03:50,550 - INFO - Data extracted from source database
2024-09-11 02:03:50,591 - INFO - Fact orders after removing duplicates: 
   order_id  company_id  customer_id  product_id  date_id  quantity total_amount order_timestamp
0         1          15           41          17        1        10      1143.30      2024-07-08
1        23          16            8          23        1        10      3897.80      2024-07-08
3         2          10           41          18        2         5       441.90      2024-04-04
6         3          14           23          15        3         4      1402.52      2023-10-23
9         4           3           37           4        4         9      1135.53      2024-05-09
2024-09-11 02:03:50,605 - INFO - Fact orders after device merge: 
   order_id  company_id  customer_id  product_id  date_id  quantity total_amount order_timestamp device_type                                         user_agent  device_id
0         1          15           41          17        1        10      1143.30      2024-07-08     Desktop  Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7...        1.0
1         1          15           41          17        1        10      1143.30      2024-07-08     Desktop  Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7...        1.0
2        23          16            8          23        1        10      3897.80      2024-07-08      Mobile  Mozilla/5.0 (Linux; Android 10; SM-G970F) Appl...        2.0
3         2          10           41          18        2         5       441.90      2024-04-04     Desktop  Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7...        1.0
4         2          10           41          18        2         5       441.90      2024-04-04     Desktop  Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7...        1.0
2024-09-11 02:03:50,606 - INFO - Data transformed into dimensional model
2024-09-11 02:03:50,784 - INFO - Dimension tables loaded and committed successfully.
2024-09-11 02:03:50,790 - INFO - Fact_Orders table truncated successfully.
2024-09-11 02:03:50,807 - ERROR - Error loading data: duplicate key value violates unique constraint "fact_orders_pkey"
DETAIL:  Key (order_id)=(1) already exists.

2024-09-11 02:03:50,807 - INFO - ETL pipeline completed
2024-09-11 02:03:50,808 - INFO - Pipeline run completed, connections closed.
